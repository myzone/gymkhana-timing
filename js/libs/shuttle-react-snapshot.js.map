{"version":3,"sources":["shuttle-react-snapshot.es6"],"names":[],"mappings":";;;;;;;;;;AAAA,MAAM,CAAC,CAAC,SAAS,EAAE,OAAO,EAAE,OAAO,CAAC,EAAE,UAAU,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE;QACzD,qBAAqB;kBAArB,qBAAqB;;AAKZ,iBALT,qBAAqB,CAKX,KAAK,EAAE;;;kCALjB,qBAAqB;;AAMnB,uCANF,qBAAqB,6CAMb,KAAK,EAAE;;AAEb,gBAAI,CAAC,cAAc,GAAG,UAAC,CAAC,EAAE,CAAC;uBAAK,MAAK,QAAQ,CAAC,MAAK,YAAY,CAAC,MAAK,KAAK,EAAE,MAAK,KAAK,CAAC,CAAC;aAAA,CAAC;AACzF,gBAAI,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC;AAC/C,gBAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC;SAC/B;;;;qBAXC,qBAAqB;;mBAaN,6BAAG;;;AAChB,iBAAC,CAAC,OAAO,CAAC,UAAA,WAAW;2BAAI,WAAW,CAAC,KAAK,CAAC,WAAW,CAAC,OAAK,cAAc,CAAC;iBAAA,EAAE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;aAClH;;;mBAEmB,gCAAG;;;AACnB,iBAAC,CAAC,OAAO,CAAC,UAAA,WAAW;2BAAI,WAAW,CAAC,KAAK,CAAC,cAAc,CAAC,OAAK,cAAc,CAAC;iBAAA,EAAE,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;aACrH;;;mBAEoB,+BAAC,SAAS,EAAE,SAAS,EAAE;AACxC,uBAAO,CAAC,CAAC,CAAC,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,IAChC,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,SAAS,EAAE,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;aACtH;;;mBAEwB,mCAAC,KAAK,EAAE;AAC7B,oBAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;aAC3D;;;mBAEiB,4BAAC,SAAS,EAAE,SAAS,EAAE;AACrC,oBAAI,CAAC,SAAS,GAAG,SAAS,CAAC;aAC9B;;;mBAEW,sBAAC,KAAK,EAAE,KAAK,EAAE;AACvB,uBAAO,CAAC,CAAC,MAAM,CAAC,UAAC,MAAM,EAAE,IAAI,EAAK;AAC9B,0BAAM,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC;;AAEpC,2BAAO,MAAM,CAAC;iBACjB,EAAE,KAAK,EAAE,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC;aAC1C;;;mBAEc,yBAAC,KAAK,EAAE;;;AACnB,uBAAO,CAAC,CAAC,MAAM,CAAC,UAAA,IAAI;2BAAI,IAAI,CAAC,KAAK,YAAY,OAAO,CAAC,GAAG;iBAAA,EAAE,CAAC,CAAC,GAAG,CAAC,UAAA,GAAG,EAAI;AACpE,2BAAO;AACH,2BAAG,EAAE,GAAG;AACR,6BAAK,EAAE,OAAK,KAAK,CAAC,GAAG,CAAC;qBACzB,CAAC;iBACL,EAAE,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAA;aAC1B;;;eAjDC,qBAAqB;OAAS,KAAK,CAAC,SAAS;;AAsDnD,WAAO,CAAC,KAAK,GAAG;AACZ,iBAAS,EAAE,qBAAqB;KACnC,CAAC;;AAEF,WAAO,6BAA6B,CAAC;CACxC,CAAC,CAAC","file":"shuttle-react-snapshot.js","sourcesContent":["define(['shuttle', 'ramda', 'react'], function (Shuttle, R, React) {\n    class ShuttleReactComponent extends React.Component {\n\n        updateListener;\n        lastState;\n\n        constructor(props) {\n            super(props);\n\n            this.updateListener = (a, b) => this.setState(this.computeState(this.props, this.state));\n            this.state = this.computeState(this.props, {});\n            this.lastState = this.state;\n        }\n\n        componentDidMount() {\n            R.forEach(shuttleProp => shuttleProp.value.addListener(this.updateListener), this.getShuttleProps(this.props));\n        }\n\n        componentWillUnmount() {\n            R.forEach(shuttleProp => shuttleProp.value.removeListener(this.updateListener), this.getShuttleProps(this.props));\n        }\n\n        shouldComponentUpdate(nextProps, nextState) {\n            return !R.eqDeep(nextProps, this.props)\n                || !R.eqDeep(this.computeState(nextProps, nextState), R.eqDeep(this.computeState(this.props, this.lastState)));\n        }\n\n        componentWillReceiveProps(props) {\n            this.setState(this.computeState(props, this.lastState));\n        }\n\n        componentDidUpdate(prevProps, prevState) {\n            this.lastState = prevState;\n        }\n\n        computeState(props, state) {\n            return R.reduce((object, prop) => {\n                object[prop.key] = prop.value.get();\n\n                return object;\n            }, state, this.getShuttleProps(props));\n        }\n\n        getShuttleProps(props) {\n            return R.filter(prop => prop.value instanceof Shuttle.Ref, R.map(key => {\n                return {\n                    key: key,\n                    value: this.props[key]\n                };\n            }, Object.keys(props)))\n        }\n\n    }\n\n    // publish\n    Shuttle.React = {\n        Component: ShuttleReactComponent\n    };\n\n    return 'use Shuttle.React.Component';\n});"]}